(this["webpackJsonpred-tetris"]=this["webpackJsonpred-tetris"]||[]).push([[0],{105:function(e,t,n){},106:function(e,t,n){},107:function(e,t,n){"use strict";n.r(t);var c=n(1),o=n(0),r=n.n(o),i=n(54),a=n.n(i),s=n(16),u=n(2),l=n(55),j=n.n(l),b=n(56),f=n.n(b),h=j()(f.a.server.url),O=r.a.createContext(h),m=n(3),d=n(7);var p=function(e,t){var n=Object(o.useRef)(null);Object(o.useEffect)((function(){n.current=e})),Object(o.useEffect)((function(){if(null!==t){var e=setInterval((function(){"undefined"!==typeof(null===n||void 0===n?void 0:n.current)&&(null===n||void 0===n||n.current())}),t);return function(){return clearInterval(e)}}}),[t])},w=n(15),v=n(14),x=n(9),y=n(28),g=function(){function e(t,n){Object(x.a)(this,e),this.x=t,this.y=n}return Object(y.a)(e,[{key:"rotate",value:function(t,n){var c=new e(this.x-t.x,this.y-t.y),o=new e(c.x*Math.cos(n)-c.y*Math.sin(n),c.x*Math.sin(n)+c.y*Math.cos(n));return new e(Math.round(o.x+t.x),Math.round(o.y+t.y))}},{key:"translateX",value:function(t){return new e(this.x+t,this.y)}},{key:"translateY",value:function(t){return new e(this.x,this.y+t)}}]),e}(),k=function(){function e(t,n,c,o){Object(x.a)(this,e),this.tetri=Object(d.a)(t),this.position=n,this.center=c,this.color=o}return Object(y.a)(e,[{key:"rotate",value:function(){var t=this;return new e(this.tetri.map((function(e){return e.rotate(t.center,90*Math.PI/180)})),this.position,this.center,this.color)}},{key:"moveRight",value:function(){return new e(Object(d.a)(this.tetri),this.position.translateX(1),this.center,this.color)}},{key:"moveLeft",value:function(){return new e(Object(d.a)(this.tetri),this.position.translateX(-1),this.center,this.color)}},{key:"moveDown",value:function(){return new e(Object(d.a)(this.tetri),this.position.translateY(1),this.center,this.color)}}]),e}(),N=function(e){Object(w.a)(n,e);var t=Object(v.a)(n);function n(e){return Object(x.a)(this,n),t.call(this,[new g(0,1),new g(1,1),new g(2,1),new g(3,1)],e,new g(1.5,1.5),"lightblue")}return n}(k),C=function(e){Object(w.a)(n,e);var t=Object(v.a)(n);function n(e){return Object(x.a)(this,n),t.call(this,[new g(0,0),new g(0,1),new g(1,1),new g(2,1)],e,new g(1,1),"blue")}return n}(k),R=function(e){Object(w.a)(n,e);var t=Object(v.a)(n);function n(e){return Object(x.a)(this,n),t.call(this,[new g(2,0),new g(0,1),new g(1,1),new g(2,1)],e,new g(1,1),"orange")}return n}(k),M=function(e){Object(w.a)(n,e);var t=Object(v.a)(n);function n(e){return Object(x.a)(this,n),t.call(this,[new g(0,0),new g(1,0),new g(0,1),new g(1,1)],e,new g(.5,.5),"yellow")}return n}(k),E=function(e){Object(w.a)(n,e);var t=Object(v.a)(n);function n(e){return Object(x.a)(this,n),t.call(this,[new g(1,0),new g(2,0),new g(0,1),new g(1,1)],e,new g(1,1),"green")}return n}(k),S=function(e){Object(w.a)(n,e);var t=Object(v.a)(n);function n(e){return Object(x.a)(this,n),t.call(this,[new g(1,0),new g(0,1),new g(1,1),new g(2,1)],e,new g(1,1),"purple")}return n}(k),A=function(e){Object(w.a)(n,e);var t=Object(v.a)(n);function n(e){return Object(x.a)(this,n),t.call(this,[new g(0,0),new g(1,0),new g(1,1),new g(2,1)],e,new g(1,1),"red")}return n}(k),D=(n(97),function(){var e=10,t=[new N(new g(3,-1)),new C(new g(3,0)),new R(new g(3,0)),new M(new g(3,0)),new E(new g(3,0)),new S(new g(3,0)),new A(new g(3,0))],n=Object(o.useState)(t[Math.round(6*Math.random())]),r=Object(m.a)(n,2),i=r[0],a=r[1],s=Object(o.useState)(new Array(20).fill().map((function(t){return new Array(e).fill("white")}))),u=Object(m.a)(s,2),l=u[0],j=u[1],b=Object(o.useState)(new Array(20).fill().map((function(t){return new Array(e).fill(0)}))),f=Object(m.a)(b,2),h=f[0],O=f[1],w=Object(o.useState)([]),v=Object(m.a)(w,2),x=v[0],y=v[1],k=Object(o.useState)(0),D=Object(m.a)(k,2),J=D[0],L=D[1],I=function(t){return!!t.tetri.find((function(n){var c=new g(t.position.x+n.x,t.position.y+n.y);return c.x<0||c.x>=e||c.y<0||c.y>=20||"white"!==l[c.y][c.x]}))},P=function(e){var t=h.map((function(e){return e.map((function(e){return 0}))}));a(e),e.tetri.map((function(n){t[e.position.y+n.y][e.position.x+n.x]=1})),O(Object(d.a)(t))},z=function(){var t=Object(d.a)(l),n=0;l.map((function(c,o){c.find((function(e){return"white"===e}))||(n+=100,t.splice(o,1),t.splice(0,0,new Array(e).fill("white")))})),L(J+(400===n?800:n)),j(t)},H=function(e){if(37===e.keyCode)I(i.moveLeft())||P(i.moveLeft());else if(39===e.keyCode)I(i.moveRight())||P(i.moveRight());else if(38===e.keyCode)I(i.rotate())||P(i.rotate());else if(40===e.keyCode)if(I(i.moveDown())){var n=Object(d.a)(l),c=t[Math.round(6*Math.random())];i.tetri.map((function(e){n[i.position.y+e.y][i.position.x+e.x]=i.color})),j(Object(d.a)(n)),I(c)?(alert("Game Over"),n=n.map((function(e){return e.map((function(e){return"white"}))})),j(n),P(c)):(z(),P(c))}else P(i.moveDown())};return Object(o.useEffect)((function(){return document.addEventListener("keydown",H),function(){return document.removeEventListener("keydown",H)}})),Object(o.useEffect)((function(){for(var t=[],n=0;n<20;++n){for(var o=[],r=0;r<e;++r)o.push(Object(c.jsx)("td",{style:{backgroundColor:h[n][r]?i.color:l[n][r]}},"".concat(n*e+r)));t.push(Object(c.jsx)("tr",{children:o},"".concat(n)))}y(t)}),[h]),p((function(){if(I(i.moveDown())){var e=Object(d.a)(l),n=t[Math.round(6*Math.random())];i.tetri.map((function(t){e[i.position.y+t.y][i.position.x+t.x]=i.color})),j(Object(d.a)(e)),I(n)?(alert("Game Over"),e=e.map((function(e){return e.map((function(e){return"white"}))})),j(e),P(n)):(z(),P(n))}else P(i.moveDown())}),1e3),Object(c.jsxs)("div",{children:[Object(c.jsx)("button",{className:"btn btn-danger m-3",onClick:function(){return P(i)},children:"Fill"}),Object(c.jsx)("label",{children:J}),Object(c.jsx)("table",{children:Object(c.jsx)("tbody",{children:x})})]})}),J=n(57),L=n.p+"static/media/tetris.7ffe6109.mp3",I=function(){var e=Object(o.useContext)(O),t=Object(o.useState)({}),n=Object(m.a)(t,2),r=n[0],i=n[1],a=Object(o.useState)({}),s=Object(m.a)(a,2),l=s[0],j=s[1],b=Object(u.e)(),f=/#([a-zA-Z]+)\[([a-zA-Z]+)\]/,h=Object(o.useState)(.1),d=Object(m.a)(h,2),p=d[0],w=d[1],v=Object(J.a)(L,{volume:p}),x=Object(m.a)(v,2),y=x[0],g=x[1].stop;Object(o.useEffect)((function(){f.exec(location.hash)?e.emit("getMyRoom",(function(e,t){e?b.push("/Home"):(j(t),i(t.players))})):b.push("/Home")}),[e]),Object(o.useEffect)((function(){e.on("updatePlayers",(function(e){i(e)}))}),[r,e]),Object(o.useEffect)((function(){return y(),function(){g()}}),[y]);return Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("h1",{children:l.name}),Object.keys(r).map((function(e,t){return Object(c.jsx)("p",{children:r[e].name},t)})),Object(c.jsx)("button",{className:"btn btn-danger",onClick:function(){w(p-.01)},children:"-"}),Object(c.jsx)("button",{className:"btn btn-danger",onClick:function(){w(0===p?.1:0)},children:"Mute"}),Object(c.jsx)("button",{className:"btn btn-danger",onClick:function(){w(p+.01)},children:"+"}),Object(c.jsx)(D,{}),Object(c.jsx)("button",{className:"btn btn-danger",onClick:function(){e.emit("leaveRoom"),b.push("/Room")},children:"Leave"})]})},P=function(){var e=Object(u.e)();return Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("h1",{children:"Bienvenue sur Red Tetris"}),Object(c.jsx)("button",{className:"btn btn-danger",onClick:function(){e.push("/Room")},children:"Play"})]})},z=(n(105),function(){var e=Object(o.useContext)(O),t=Object(u.e)(),n=Object(o.useState)({}),r=Object(m.a)(n,2),i=r[0],a=r[1];return Object(o.useEffect)((function(){e.emit("getRooms",(function(e){a(e)}))}),[e]),Object(o.useEffect)((function(){e.on("updateRooms",(function(e){a(e)}))}),[i]),Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("h1",{children:"Room list"}),Object(c.jsx)("div",{className:"list-group mb-3",children:Object.keys(i).map((function(e,n){return Object(c.jsxs)("li",{className:"list-group-item p-1",children:[Object(c.jsx)("label",{children:Object(c.jsx)("b",{children:i[e].name})}),Object(c.jsx)("button",{className:"btn btn-danger float-right",onClick:function(){return n=i[e].name,void t.push("/Join-room#".concat(n));var n},children:"Join"})]},n)}))}),Object(c.jsx)("button",{className:"btn btn-danger",onClick:function(){t.push("/New-room")},children:"Create New Room"})]})}),H=function(){var e=Object(o.useContext)(O),t=Object(u.e)(),n=Object(o.useState)(""),r=Object(m.a)(n,2),i=r[0],a=r[1],s=Object(o.useState)(""),l=Object(m.a)(s,2),j=l[0],b=l[1];return Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("h1",{children:"New Room Creation"}),Object(c.jsxs)("form",{children:[Object(c.jsx)("div",{className:"form-group",children:Object(c.jsx)("input",{className:"form-control",type:"text",placeholder:"Username",onChange:function(e){a(e.target.value)}})}),Object(c.jsx)("div",{className:"form-group",children:Object(c.jsx)("input",{className:"form-control",type:"text",placeholder:"Room name",onChange:function(e){b(e.target.value)}})}),Object(c.jsx)("input",{className:"btn btn-danger",type:"submit",value:"Create",onClick:function(n){n.preventDefault(),i&&j&&(e.emit("join",i),e.emit("addRoom",j,(function(e){e?alert("Room name already exist"):t.push("/#".concat(j,"[").concat(i,"]"))})))}})]})]})},U=function(){var e=Object(o.useContext)(O),t=Object(o.useState)(""),n=Object(m.a)(t,2),r=n[0],i=n[1],a=Object(o.useState)(""),s=Object(m.a)(a,2),l=s[0],j=s[1],b=Object(u.e)(),f=/#([a-zA-Z]+)/;Object(o.useEffect)((function(){j(f.exec(location.hash)[1])}),[location.hash]);return Object(c.jsxs)("div",{className:"container",children:[Object(c.jsxs)("h1",{children:['Join "',l,'"']}),Object(c.jsxs)("form",{children:[Object(c.jsx)("div",{className:"form-group",children:Object(c.jsx)("input",{className:"form-control",placeholder:"Username",onChange:function(e){i(e.target.value)}})}),Object(c.jsx)("input",{className:"btn btn-danger",type:"submit",value:"Join",onClick:function(t){t.preventDefault(),r&&(e.emit("join",r),e.emit("joinRoom",l,(function(e){e?alert("Username already taken"):b.push("/#".concat(l,"[").concat(r,"]"))})))}})]})]})},X=(n(106),function(){return Object(c.jsx)(O.Provider,{value:h,children:Object(c.jsxs)(s.a,{children:[Object(c.jsx)(u.a,{path:"/",exact:!0,component:I}),Object(c.jsx)(u.a,{path:"/Home",component:P}),Object(c.jsx)(u.a,{path:"/Room",component:z}),Object(c.jsx)(u.a,{path:"/New-room",component:H}),Object(c.jsx)(u.a,{path:"/Join-room",component:U})]})})});a.a.render(Object(c.jsx)(X,{}),document.getElementById("tetris"))},56:function(e,t){var n={server:{host:"localhost",port:"3004",get url(){return"http://"+this.host+":"+this.port}}};e.exports=n},97:function(e,t,n){}},[[107,1,2]]]);
//# sourceMappingURL=main.4897d4c3.chunk.js.map