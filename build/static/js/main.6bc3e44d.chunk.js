(this["webpackJsonptest-build"]=this["webpackJsonptest-build"]||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){},102:function(e,t,n){"use strict";n.r(t);var c=n(1),o=n(0),r=n.n(o),i=n(56),a=n.n(i),s=n(16),u=n(2),l=n(57),j={server:{host:"localhost",port:3004,get url(){return"http://"+this.host+":"+this.port}}},b=n.n(l)()(j.server.url),f=r.a.createContext(b),h=n(4),O=n(7);var m=function(e,t){var n=Object(o.useRef)(null);Object(o.useEffect)((function(){n.current=e})),Object(o.useEffect)((function(){if(null!==t){var e=setInterval((function(){"undefined"!==typeof(null===n||void 0===n?void 0:n.current)&&(null===n||void 0===n||n.current())}),t);return function(){return clearInterval(e)}}}),[t])},d=n(15),p=n(14),w=n(9),v=n(28),x=function(){function e(t,n){Object(w.a)(this,e),this.x=t,this.y=n}return Object(v.a)(e,[{key:"rotate",value:function(t,n){var c=new e(this.x-t.x,this.y-t.y),o=new e(c.x*Math.cos(n)-c.y*Math.sin(n),c.x*Math.sin(n)+c.y*Math.cos(n));return new e(Math.round(o.x+t.x),Math.round(o.y+t.y))}},{key:"translateX",value:function(t){return new e(this.x+t,this.y)}},{key:"translateY",value:function(t){return new e(this.x,this.y+t)}}]),e}(),y=function(){function e(t,n,c,o){Object(w.a)(this,e),this.tetri=Object(O.a)(t),this.position=n,this.center=c,this.color=o}return Object(v.a)(e,[{key:"rotate",value:function(){var t=this;return new e(this.tetri.map((function(e){return e.rotate(t.center,90*Math.PI/180)})),this.position,this.center,this.color)}},{key:"moveRight",value:function(){return new e(Object(O.a)(this.tetri),this.position.translateX(1),this.center,this.color)}},{key:"moveLeft",value:function(){return new e(Object(O.a)(this.tetri),this.position.translateX(-1),this.center,this.color)}},{key:"moveDown",value:function(){return new e(Object(O.a)(this.tetri),this.position.translateY(1),this.center,this.color)}}]),e}(),g=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(w.a)(this,n),t.call(this,[new x(0,1),new x(1,1),new x(2,1),new x(3,1)],e,new x(1.5,1.5),"lightblue")}return n}(y),k=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(w.a)(this,n),t.call(this,[new x(0,0),new x(0,1),new x(1,1),new x(2,1)],e,new x(1,1),"blue")}return n}(y),N=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(w.a)(this,n),t.call(this,[new x(2,0),new x(0,1),new x(1,1),new x(2,1)],e,new x(1,1),"orange")}return n}(y),C=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(w.a)(this,n),t.call(this,[new x(0,0),new x(1,0),new x(0,1),new x(1,1)],e,new x(.5,.5),"yellow")}return n}(y),R=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(w.a)(this,n),t.call(this,[new x(1,0),new x(2,0),new x(0,1),new x(1,1)],e,new x(1,1),"green")}return n}(y),M=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(w.a)(this,n),t.call(this,[new x(1,0),new x(0,1),new x(1,1),new x(2,1)],e,new x(1,1),"purple")}return n}(y),E=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(w.a)(this,n),t.call(this,[new x(0,0),new x(1,0),new x(1,1),new x(2,1)],e,new x(1,1),"red")}return n}(y),S=(n(95),function(){var e=10,t=[new g(new x(3,-1)),new k(new x(3,0)),new N(new x(3,0)),new C(new x(3,0)),new R(new x(3,0)),new M(new x(3,0)),new E(new x(3,0))],n=Object(o.useState)(t[Math.round(6*Math.random())]),r=Object(h.a)(n,2),i=r[0],a=r[1],s=Object(o.useState)(new Array(20).fill().map((function(t){return new Array(e).fill("white")}))),u=Object(h.a)(s,2),l=u[0],j=u[1],b=Object(o.useState)(new Array(20).fill().map((function(t){return new Array(e).fill(0)}))),f=Object(h.a)(b,2),d=f[0],p=f[1],w=Object(o.useState)([]),v=Object(h.a)(w,2),y=v[0],S=v[1],A=function(t){return!!t.tetri.find((function(n){var c=new x(t.position.x+n.x,t.position.y+n.y);return c.x<0||c.x>=e||c.y<0||c.y>=20||"white"!==l[c.y][c.x]}))},D=function(e){var t=d.map((function(e){return e.map((function(e){return 0}))}));a(e),e.tetri.map((function(n){t[e.position.y+n.y][e.position.x+n.x]=1})),p(Object(O.a)(t))},J=function(){var t=Object(O.a)(l);l.map((function(n,c){n.find((function(e){return"white"===e}))||(t.splice(c,1),t.splice(0,0,new Array(e).fill("white")))})),j(t)},L=function(e){if(37===e.keyCode)A(i.moveLeft())||D(i.moveLeft());else if(39===e.keyCode)A(i.moveRight())||D(i.moveRight());else if(38===e.keyCode)A(i.rotate())||D(i.rotate());else if(40===e.keyCode)if(A(i.moveDown())){var n=Object(O.a)(l),c=t[Math.round(6*Math.random())];i.tetri.map((function(e){n[i.position.y+e.y][i.position.x+e.x]=i.color})),j(Object(O.a)(n)),A(c)?(alert("Game Over"),n=n.map((function(e){return e.map((function(e){return"white"}))})),j(n),D(c)):(J(),D(c))}else D(i.moveDown())};return Object(o.useEffect)((function(){return document.addEventListener("keydown",L),function(){return document.removeEventListener("keydown",L)}})),Object(o.useEffect)((function(){for(var t=[],n=0;n<20;++n){for(var o=[],r=0;r<e;++r)o.push(Object(c.jsx)("td",{style:{backgroundColor:d[n][r]?i.color:l[n][r]}},"".concat(n*e+r)));t.push(Object(c.jsx)("tr",{children:o},"".concat(n)))}S(t)}),[d]),m((function(){if(A(i.moveDown())){var e=Object(O.a)(l),n=t[Math.round(6*Math.random())];i.tetri.map((function(t){e[i.position.y+t.y][i.position.x+t.x]=i.color})),j(Object(O.a)(e)),A(n)?(alert("Game Over"),e=e.map((function(e){return e.map((function(e){return"white"}))})),j(e),D(n)):(J(),D(n))}else D(i.moveDown())}),1e3),Object(c.jsxs)("div",{children:[Object(c.jsx)("button",{className:"btn btn-danger m-3",onClick:function(){return D(i)},children:"Fill"}),Object(c.jsx)("table",{children:Object(c.jsx)("tbody",{children:y})})]})}),A=n(58),D=n.p+"static/media/tetris.7ffe6109.mp3",J=function(){var e=Object(o.useContext)(f),t=Object(o.useState)({}),n=Object(h.a)(t,2),r=n[0],i=n[1],a=Object(o.useState)({}),s=Object(h.a)(a,2),l=s[0],j=s[1],b=Object(u.e)(),O=/#([a-zA-Z]+)\[([a-zA-Z]+)\]/,m=Object(o.useState)(.1),d=Object(h.a)(m,2),p=d[0],w=d[1],v=Object(A.a)(D,{volume:p}),x=Object(h.a)(v,2),y=x[0],g=x[1].stop;Object(o.useEffect)((function(){O.exec(location.hash)?e.emit("getMyRoom",(function(e,t){e?b.push("/Home"):(j(t),i(t.players))})):b.push("/Home")}),[e]),Object(o.useEffect)((function(){e.on("updatePlayers",(function(e){i(e)}))}),[r,e]),Object(o.useEffect)((function(){return y(),function(){g()}}),[y]);return Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("h1",{children:l.name}),Object.keys(r).map((function(e,t){return Object(c.jsx)("p",{children:r[e].name},t)})),Object(c.jsx)("button",{className:"btn btn-danger",onClick:function(){w(p-.01)},children:"-"}),Object(c.jsx)("button",{className:"btn btn-danger",onClick:function(){w(0===p?.1:0)},children:"Mute"}),Object(c.jsx)("button",{className:"btn btn-danger",onClick:function(){w(p+.01)},children:"+"}),Object(c.jsx)(S,{}),Object(c.jsx)("button",{className:"btn btn-danger",onClick:function(){e.emit("leaveRoom"),b.push("/Room")},children:"Leave"})]})},L=function(){var e=Object(u.e)();return Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("h1",{children:"Bienvenue sur Red Tetris"}),Object(c.jsx)("button",{className:"btn btn-danger",onClick:function(){e.push("/Room")},children:"Play"})]})},I=(n(100),function(){var e=Object(o.useContext)(f),t=Object(u.e)(),n=Object(o.useState)({}),r=Object(h.a)(n,2),i=r[0],a=r[1];return Object(o.useEffect)((function(){e.emit("getRooms",(function(e){a(e)}))}),[e]),Object(o.useEffect)((function(){e.on("updateRooms",(function(e){a(e)}))}),[i]),Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("h1",{children:"Room list"}),Object(c.jsx)("div",{className:"list-group mb-3",children:Object.keys(i).map((function(e,n){return Object(c.jsxs)("li",{className:"list-group-item p-1",children:[Object(c.jsx)("label",{children:Object(c.jsx)("b",{children:i[e].name})}),Object(c.jsx)("button",{className:"btn btn-danger float-right",onClick:function(){return n=i[e].name,void t.push("/Join-room#".concat(n));var n},children:"Join"})]},n)}))}),Object(c.jsx)("button",{className:"btn btn-danger",onClick:function(){t.push("/New-room")},children:"Create New Room"})]})}),P=function(){var e=Object(o.useContext)(f),t=Object(u.e)(),n=Object(o.useState)(""),r=Object(h.a)(n,2),i=r[0],a=r[1],s=Object(o.useState)(""),l=Object(h.a)(s,2),j=l[0],b=l[1];return Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("h1",{children:"New Room Creation"}),Object(c.jsxs)("form",{children:[Object(c.jsx)("div",{className:"form-group",children:Object(c.jsx)("input",{className:"form-control",type:"text",placeholder:"Username",onChange:function(e){a(e.target.value)}})}),Object(c.jsx)("div",{className:"form-group",children:Object(c.jsx)("input",{className:"form-control",type:"text",placeholder:"Room name",onChange:function(e){b(e.target.value)}})}),Object(c.jsx)("input",{className:"btn btn-danger",type:"submit",value:"Create",onClick:function(n){n.preventDefault(),i&&j&&(e.emit("join",i),e.emit("addRoom",j,(function(e){e?alert("Room name already exist"):t.push("/#".concat(j,"[").concat(i,"]"))})))}})]})]})},z=function(){var e=Object(o.useContext)(f),t=Object(o.useState)(""),n=Object(h.a)(t,2),r=n[0],i=n[1],a=Object(o.useState)(""),s=Object(h.a)(a,2),l=s[0],j=s[1],b=Object(u.e)(),O=/#([a-zA-Z]+)/;Object(o.useEffect)((function(){j(O.exec(location.hash)[1])}),[location.hash]);return Object(c.jsxs)("div",{className:"container",children:[Object(c.jsxs)("h1",{children:['Join "',l,'"']}),Object(c.jsxs)("form",{children:[Object(c.jsx)("div",{className:"form-group",children:Object(c.jsx)("input",{className:"form-control",placeholder:"Username",onChange:function(e){i(e.target.value)}})}),Object(c.jsx)("input",{className:"btn btn-danger",type:"submit",value:"Join",onClick:function(t){t.preventDefault(),r&&(e.emit("join",r),e.emit("joinRoom",l,(function(e){e?alert("Username already taken"):b.push("/#".concat(l,"[").concat(r,"]"))})))}})]})]})},H=(n(101),function(){return Object(c.jsx)(f.Provider,{value:b,children:Object(c.jsxs)(s.a,{children:[Object(c.jsx)(u.a,{path:"/",exact:!0,component:J}),Object(c.jsx)(u.a,{path:"/Home",component:L}),Object(c.jsx)(u.a,{path:"/Room",component:I}),Object(c.jsx)(u.a,{path:"/New-room",component:P}),Object(c.jsx)(u.a,{path:"/Join-room",component:z})]})})});a.a.render(Object(c.jsx)(H,{}),document.getElementById("tetris"))},95:function(e,t,n){}},[[102,1,2]]]);
//# sourceMappingURL=main.6bc3e44d.chunk.js.map