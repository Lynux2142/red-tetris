(this["webpackJsonpred-tetris"]=this["webpackJsonpred-tetris"]||[]).push([[0],{81:function(t,n){},84:function(t,n){var e={server:{host:"localhost",port:"3004",get url(){return"http://"+this.host+":"+this.port}}};t.exports=e},85:function(t,n,e){},94:function(t,n,e){},95:function(t,n,e){},96:function(t,n,e){"use strict";e.r(n);var c=e(1),r=e(0),o=e.n(r),i=e(50),a=e.n(i),s=e(12),u=e(3),b=e(51),j=e.n(b),l=(e(84),j()("https://red-tetris-malg.herokuapp.com/")),f=o.a.createContext(l),d=e(2),O=e(10);var m=function(t,n){var e=Object(r.useRef)(null);Object(r.useEffect)((function(){e.current=t})),Object(r.useEffect)((function(){if(null!==n){var t=setInterval((function(){"undefined"!==typeof(null===e||void 0===e?void 0:e.current)&&(null===e||void 0===e||e.current())}),n);return function(){return clearInterval(t)}}}),[n])},h=e(11);var x={rotate:function(t,n,e){var c=t.x-n.x,r=t.y-n.y;return{x:Math.round(c*Math.cos(e)-r*Math.sin(e)+n.x),y:Math.round(c*Math.sin(e)+r*Math.cos(e)+n.y)}},translateX:function(t,n){return{x:t.x+n,y:t.y}},translateY:function(t,n){return{x:t.x,y:t.y+n}}};var p={rotate:function(t){return Object(h.a)(Object(h.a)({},t),{},{points:t.points.map((function(n){return x.rotate(n,t.center,90*Math.PI/180)}))})},Right:function(t){return Object(h.a)(Object(h.a)({},t),{},{position:x.translateX(t.position,1)})},Left:function(t){return Object(h.a)(Object(h.a)({},t),{},{position:x.translateX(t.position,-1)})},Down:function(t){return Object(h.a)(Object(h.a)({},t),{},{position:x.translateY(t.position,1)})}},v=(e(85),e(5)),g=e(6);function y(){var t=Object(v.a)(["\n  display: flex;\n  align-items: flex-start;\n  padding: 40px;\n  margin: 0 auto;\n  max-width: 900px;\n  aside {\n    width: 100%;\n    max-width: 200px;\n    display: block;\n    padding: 0 20px;\n  }\n"]);return y=function(){return t},t}function w(){var t=Object(v.a)(["\n  width: 100vw;\n  height: 100vh;\n  overflow: hidden;\n"]);return w=function(){return t},t}var k=g.a.div(w()),C=g.a.div(y());function N(){var t=Object(v.a)(["\n  box-sizing: border-box;\n  display: flex;\n  align-items: center; \n  margin: 0 0 20px 0;\n  padding: 20px;\n  border: 4px solid #333;\n  min-height: 30px;\n  width: 100%;\n  border-radius: 20px;\n  color: ",";\n  background: #000;\n  font-family: Pixel, Arial, Helvetica, sans-serif;\n  font-size: 0.8rem;\n"]);return N=function(){return t},t}var S=g.a.div(N(),(function(t){return t.gameOver?"red":"#999"})),R=function(t){var n=t.gameOver,e=t.text;return Object(c.jsx)(S,{gameOver:n,children:e})};function z(){var t=Object(v.a)(["\n  box-sizing: border-box;\n  margin: 0 0 20px 0;\n  padding: 20px;\n  min-height: 30px;\n  width: 100%;\n  border-radius: 20px;\n  border: none;\n  color: white;\n  background: #333;\n  font-family: Pixel, Arial, Helvetica, sans-serif;\n  font-size: 1rem;\n  outline: none;\n  cursor: pointer;\n"]);return z=function(){return t},t}var A=g.a.button(z()),E=function(t){var n=t.callback;return Object(c.jsx)(A,{onClick:n,children:"Start Game"})},M=o.a.memo(E);function P(){var t=Object(v.a)(["\n  box-sizing: border-box;\n  margin: 0 0 0.5vw 0;\n  padding: 0.5vw;\n  min-height: 0.1vw;\n  width: 100%;\n  border-radius: 1vw;\n  border: none;\n  color: white;\n  background: #333;\n  font-family: Pixel, Arial, Helvetica, sans-serif;\n  font-size: 1rem;\n  outline: none;\n  cursor: pointer;\n"]);return P=function(){return t},t}function D(){var t=Object(v.a)(["\n  box-sizing: border-box;\n  margin: 0 0 0.5vw 0;\n  padding: 1vw;\n  min-height: 0.2vw;\n  width: 100%;\n  border-radius: 1vw;\n  border: none;\n  color: white;\n  background: #333;\n  font-family: Pixel, Arial, Helvetica, sans-serif;\n  font-size: 1rem;\n  outline: none;\n  cursor: pointer;\n"]);return D=function(){return t},t}function H(){var t=Object(v.a)(["\n  display: flex;\n  overflow: auto;\n"]);return H=function(){return t},t}var J=g.a.div(H()),I=g.a.button(D()),G=g.a.button(P()),L=e(55),T=e.p+"static/media/tetris.7ffe6109.mp3",U=function(){var t=Object(r.useState)(.1),n=Object(d.a)(t,2),e=n[0],o=n[1],i=Object(r.useState)(!0),a=Object(d.a)(i,2),s=a[0],u=a[1],b=Object(L.a)(T,{volume:s?0:e}),j=Object(d.a)(b,2),l=j[0],f=j[1].stop;return Object(r.useEffect)((function(){return l(),function(){f()}}),[l]),Object(c.jsxs)(J,{children:[Object(c.jsx)(G,{className:"btn btn-danger",onClick:function(){o(e-.01)},children:"-"}),Object(c.jsx)(I,{className:"btn btn-danger",onClick:function(){u(!s)},children:s?"Unmute":"Mute"}),Object(c.jsx)(G,{className:"btn btn-danger",onClick:function(){o(e+.01)},children:"+"})]})};function X(){var t=Object(v.a)(["\n  box-sizing: border-box;\n  margin: 0 0 20px 0;\n  padding: 20px;\n  min-height: 30px;\n  width: 100%;\n  border-radius: 20px;\n  border: none;\n  color: white;\n  background: #333;\n  font-family: Pixel, Arial, Helvetica, sans-serif;\n  font-size: 1rem;\n  outline: none;\n  cursor: pointer;\n"]);return X=function(){return t},t}var Z=g.a.button(X()),B=function(){var t=Object(r.useContext)(f),n=Object(u.e)();return Object(c.jsx)("div",{children:Object(c.jsx)(Z,{className:"btn btn-danger",onClick:function(){t.emit("leaveRoom"),n.push("/Room")},children:"Leave Room"})})},Y=function(t){return Object(c.jsxs)("aside",{children:[t.gameOver?Object(c.jsx)(R,{gameOver:t.gameOver,text:"Game Over"}):Object(c.jsxs)("div",{children:[Object(c.jsx)(U,{}),Object(c.jsx)(R,{text:"Score: ".concat(t.score)})]}),Object(c.jsx)(M,{callback:t.startGame}),Object(c.jsx)(B,{})]})},K=function(){var t=Object(r.useContext)(f),n=10,e=Object(r.useState)(!1),o=Object(d.a)(e,2),i=o[0],a=o[1],s=Object(r.useState)([]),u=Object(d.a)(s,2),b=u[0],j=u[1],l=Object(r.useState)({}),h=Object(d.a)(l,2),x=h[0],v=h[1],g=Object(r.useState)(new Array(20).fill().map((function(t){return new Array(n).fill("white")}))),y=Object(d.a)(g,2),w=y[0],N=y[1],S=Object(r.useState)(new Array(20).fill().map((function(t){return new Array(n).fill(0)}))),R=Object(d.a)(S,2),z=R[0],A=R[1],E=Object(r.useState)([]),M=Object(d.a)(E,2),P=M[0],D=M[1],H=Object(r.useState)(!1),J=Object(d.a)(H,2),I=J[0],G=J[1],L=Object(r.useState)(0),T=Object(d.a)(L,2),U=T[0],X=T[1],Z=function(t){return!!t.points.find((function(e){var c=t.position.x+e.x,r=t.position.y+e.y;return c<0||c>=n||r<0||r>=20||"white"!==w[r][c]}))},B=function(t){var n=z.map((function(t){return t.map((function(t){return 0}))}));v(t),t.points.map((function(e){n[t.position.y+e.y][t.position.x+e.x]=1})),A(Object(O.a)(n))},K=function(){var e=Object(O.a)(w);x.points.map((function(t){e[x.position.y+t.y][x.position.x+t.x]=x.color})),t.emit("updateSpectrum",function(){for(var t=[],e=0;e<n;++e){for(var c=0,r=0;r<20;++r)"white"===w[r][e]&&++c;t.push(c)}return t}()),N(Object(O.a)(e));var c=b.shift();b.length<3&&t.emit("getTetris",(function(t){j((function(n){return[].concat(Object(O.a)(n),[t])}))})),Z(c)?(G(!0),a(!1)):(!function(){var t=Object(O.a)(w),e=0;w.map((function(c,r){c.find((function(t){return"white"===t}))||(e+=100,t.splice(r,1),t.splice(0,0,new Array(n).fill("white")))})),X((function(t){return t+(400===e?2*e:e)})),N(t)}(),B(c))};Object(r.useEffect)((function(){for(var t=[],e=0;e<20;++e){for(var r=[],o=0;o<n;++o)r.push(Object(c.jsx)("td",{style:{backgroundColor:z[e][o]?x.color:w[e][o]}},"".concat(e*n+o)));t.push(Object(c.jsx)("tr",{children:r},"".concat(e)))}D(t)}),[z]),m((function(){!I&&i&&(Z(p.Down(x))?K():B(p.Down(x)))}),1e3),Object(r.useEffect)((function(){t.on("newTetris",(function(t){j((function(n){return[].concat(Object(O.a)(n),[t])}))}))}),[]),Object(r.useEffect)((function(){t.on("getSetTetris",(function(t){var n=t.shift(),e=Object(O.a)(w);a(!0),e=e.map((function(t){return t.map((function(t){return"white"}))})),N(e),j(Object(O.a)(t)),v(n),B(n),G(!1),X(0)}))}),[]);return Object(c.jsx)(k,{role:"button",tabIndex:"0",onKeyDown:function(t){return function(t){37===t.keyCode?Z(p.Left(x))||B(p.Left(x)):39===t.keyCode?Z(p.Right(x))||B(p.Right(x)):38===t.keyCode?Z(p.rotate(x))||B(p.rotate(x)):40===t.keyCode&&(Z(p.Down(x))?K():(X((function(t){return t+1})),B(p.Down(x))))}(t)},children:Object(c.jsxs)(C,{children:[Object(c.jsx)("table",{children:Object(c.jsx)("tbody",{children:P})}),Object(c.jsx)(Y,{gameOver:I,startGame:function(){t.emit("start")},score:U})]})})},q=function(){var t=Object(r.useContext)(f),n=Object(r.useState)({}),e=Object(d.a)(n,2),o=e[0],i=e[1],a=Object(r.useState)({}),s=Object(d.a)(a,2),b=s[0],j=s[1],l=Object(u.e)(),O=/#([a-zA-Z]+)\[([a-zA-Z]+)\]/;return Object(r.useEffect)((function(){O.exec(location.hash)?t.emit("getMyRoom",(function(t,n){t?l.push("/Home"):(j(n),i(n.players))})):l.push("/Home")}),[t]),Object(r.useEffect)((function(){t.on("updatePlayers",(function(t){i(t)}))}),[o,t]),Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("h1",{children:b.name}),Object.keys(o).map((function(t,n){return Object(c.jsx)("p",{children:o[t].name},n)})),Object(c.jsx)(K,{})]})},F=function(){var t=Object(u.e)();return Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("h1",{children:"Bienvenue sur Red Tetris"}),Object(c.jsx)("button",{className:"btn btn-danger",onClick:function(){t.push("/Room")},children:"Play"})]})},Q=(e(94),function(){var t=Object(r.useContext)(f),n=Object(u.e)(),e=Object(r.useState)({}),o=Object(d.a)(e,2),i=o[0],a=o[1];return Object(r.useEffect)((function(){t.emit("getRooms",(function(t){a(t)}))}),[t]),Object(r.useEffect)((function(){t.on("updateRooms",(function(t){a(t)}))}),[i]),Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("h1",{children:"Room list"}),Object(c.jsx)("div",{className:"list-group mb-3",children:Object.keys(i).map((function(t,e){return Object(c.jsxs)("li",{className:"list-group-item p-1",children:[Object(c.jsx)("label",{children:Object(c.jsx)("b",{children:i[t].name})}),Object(c.jsx)("button",{className:"btn btn-danger float-right",onClick:function(){return e=i[t].name,void n.push("/Join-room#".concat(e));var e},children:"Join"})]},e)}))}),Object(c.jsx)("button",{className:"btn btn-danger",onClick:function(){n.push("/New-room")},children:"Create New Room"})]})}),V=function(){var t=Object(r.useContext)(f),n=Object(u.e)(),e=Object(r.useState)(""),o=Object(d.a)(e,2),i=o[0],a=o[1],s=Object(r.useState)(""),b=Object(d.a)(s,2),j=b[0],l=b[1];return Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("h1",{children:"New Room Creation"}),Object(c.jsxs)("form",{children:[Object(c.jsx)("div",{className:"form-group",children:Object(c.jsx)("input",{className:"form-control",type:"text",placeholder:"Username",onChange:function(t){a(t.target.value)}})}),Object(c.jsx)("div",{className:"form-group",children:Object(c.jsx)("input",{className:"form-control",type:"text",placeholder:"Room name",onChange:function(t){l(t.target.value)}})}),Object(c.jsx)("input",{className:"btn btn-danger",type:"submit",value:"Create",onClick:function(e){e.preventDefault(),i&&j&&(t.emit("join",i),t.emit("addRoom",j,(function(t){t?alert("Room name already exist"):n.push("/#".concat(j,"[").concat(i,"]"))})))}})]})]})},W=function(){var t=Object(r.useContext)(f),n=Object(r.useState)(""),e=Object(d.a)(n,2),o=e[0],i=e[1],a=Object(r.useState)(""),s=Object(d.a)(a,2),b=s[0],j=s[1],l=Object(u.e)(),O=/#([a-zA-Z]+)/;Object(r.useEffect)((function(){j(O.exec(location.hash)[1])}),[location.hash]);return Object(c.jsxs)("div",{className:"container",children:[Object(c.jsxs)("h1",{children:['Join "',b,'"']}),Object(c.jsxs)("form",{children:[Object(c.jsx)("div",{className:"form-group",children:Object(c.jsx)("input",{className:"form-control",placeholder:"Username",onChange:function(t){i(t.target.value)}})}),Object(c.jsx)("input",{className:"btn btn-danger",type:"submit",value:"Join",onClick:function(n){n.preventDefault(),o&&(t.emit("join",o),t.emit("joinRoom",b,(function(t){t?alert("Username already taken"):l.push("/#".concat(b,"[").concat(o,"]"))})))}})]})]})},$=(e(95),function(){return Object(c.jsx)(f.Provider,{value:l,children:Object(c.jsxs)(s.a,{children:[Object(c.jsx)(u.a,{path:"/",exact:!0,component:q}),Object(c.jsx)(u.a,{path:"/Home",component:F}),Object(c.jsx)(u.a,{path:"/Room",component:Q}),Object(c.jsx)(u.a,{path:"/New-room",component:V}),Object(c.jsx)(u.a,{path:"/Join-room",component:W})]})})});a.a.render(Object(c.jsx)($,{}),document.getElementById("tetris"))}},[[96,1,2]]]);
//# sourceMappingURL=main.e2a654c8.chunk.js.map