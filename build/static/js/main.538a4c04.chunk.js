(this["webpackJsonpred-tetris"]=this["webpackJsonpred-tetris"]||[]).push([[0],{82:function(n,e){},85:function(n,e){var t={server:{host:"localhost",port:"3004",get url(){return"http://"+this.host+":"+this.port}}};n.exports=t},94:function(n,e,t){},95:function(n,e,t){},96:function(n,e,t){"use strict";t.r(e);var r=t(1),c=t(0),o=t.n(c),i=t(50),a=t.n(i),s=t(12),u=t(3),b=t(51),l=t.n(b),j=(t(85),l()("https://red-tetris-malg.herokuapp.com/")),f=o.a.createContext(j),d=t(11),O=t(7),m=t(2),p=t(4),x=t(5);function h(){var n=Object(p.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  align-items: flex-start;\n"]);return h=function(){return n},n}function v(){var n=Object(p.a)(["\n  padding: 3.5%;\n  max-width: 50%;\n  .cell {\n    border: solid 1px;\n    width: 2vw;\n    height: 2vw;\n    background: rgba(",", 0.8);\n    border-bottom-color: rgba(",", 0.1);\n    border-right-color: rgba(",", 1);\n    border-top-color: rgba(",", 1);\n    border-left-color: rgba(",", 0.3);\n  }\n"]);return v=function(){return n},n}var g=x.a.div(v(),(function(n){return n.color}),(function(n){return n.color}),(function(n){return n.color}),(function(n){return n.color}),(function(n){return n.color})),y=x.a.div(h()),w=function(n){return Object(r.jsx)(g,{children:Object(r.jsx)(y,{children:Object(r.jsx)("table",{children:Object(r.jsx)("tbody",{children:n.HTMLgrid})})})})};var k=function(n,e){var t=Object(c.useRef)(null);Object(c.useEffect)((function(){t.current=n})),Object(c.useEffect)((function(){if(null!==e){var n=setInterval((function(){"undefined"!==typeof(null===t||void 0===t?void 0:t.current)&&(null===t||void 0===t||t.current())}),e);return function(){return clearInterval(n)}}}),[e])};var C={rotate:function(n,e,t){var r=n.x-e.x,c=n.y-e.y;return{x:Math.round(r*Math.cos(t)-c*Math.sin(t)+e.x),y:Math.round(r*Math.sin(t)+c*Math.cos(t)+e.y)}},translateX:function(n,e){return{x:n.x+e,y:n.y}},translateY:function(n,e){return{x:n.x,y:n.y+e}}};var N={rotate:function(n){return Object(O.a)(Object(O.a)({},n),{},{points:n.points.map((function(e){return C.rotate(e,n.center,90*Math.PI/180)}))})},Right:function(n){return Object(O.a)(Object(O.a)({},n),{},{position:C.translateX(n.position,1)})},Left:function(n){return Object(O.a)(Object(O.a)({},n),{},{position:C.translateX(n.position,-1)})},Down:function(n){return Object(O.a)(Object(O.a)({},n),{},{position:C.translateY(n.position,1)})}};function S(){var n=Object(p.a)(["\n  box-sizing: border-box;\n  display: flex;\n  align-items: center; \n  margin: 0 0 20px 0;\n  padding: 20px;\n  border: 4px solid #333;\n  min-height: 30px;\n  width: 100%;\n  border-radius: 20px;\n  color: ",";\n  background: #000;\n  font-family: Pixel, Arial, Helvetica, sans-serif;\n  font-size: 0.8rem;\n"]);return S=function(){return n},n}var R=x.a.div(S(),(function(n){return n.gameOver?"red":"#999"})),z=function(n){var e=n.gameOver,t=n.text;return Object(r.jsx)(R,{gameOver:e,children:t})};function E(){var n=Object(p.a)(["\n  box-sizing: border-box;\n  margin: 0 0 20px 0;\n  padding: 20px;\n  min-height: 30px;\n  width: 100%;\n  border-radius: 20px;\n  border: none;\n  color: white;\n  background: #333;\n  font-family: Pixel, Arial, Helvetica, sans-serif;\n  font-size: 1rem;\n  outline: none;\n  cursor: pointer;\n"]);return E=function(){return n},n}var A=x.a.button(E()),P=function(n){var e=n.callback;return Object(r.jsx)(A,{onClick:e,children:"Start Game"})},D=o.a.memo(P);function H(){var n=Object(p.a)(["\n  box-sizing: border-box;\n  margin: 0 0 0.5vw 0;\n  padding: 0.5vw;\n  min-height: 0.1vw;\n  width: 100%;\n  border-radius: 1vw;\n  border: none;\n  color: white;\n  background: #333;\n  font-family: Pixel, Arial, Helvetica, sans-serif;\n  font-size: 1rem;\n  outline: none;\n  cursor: pointer;\n"]);return H=function(){return n},n}function M(){var n=Object(p.a)(["\n  box-sizing: border-box;\n  margin: 0 0 0.5vw 0;\n  padding: 1vw;\n  min-height: 0.2vw;\n  width: 100%;\n  border-radius: 1vw;\n  border: none;\n  color: white;\n  background: #333;\n  font-family: Pixel, Arial, Helvetica, sans-serif;\n  font-size: 1rem;\n  outline: none;\n  cursor: pointer;\n"]);return M=function(){return n},n}function I(){var n=Object(p.a)(["\n  display: flex;\n  overflow: auto;\n"]);return I=function(){return n},n}var L=x.a.div(I()),T=x.a.button(M()),B=x.a.button(H()),G=t(55),J=t.p+"static/media/tetris.7ffe6109.mp3",U=function(){var n=Object(c.useState)(.1),e=Object(m.a)(n,2),t=e[0],o=e[1],i=Object(c.useState)(!1),a=Object(m.a)(i,2),s=a[0],u=a[1],b=Object(G.a)(J,{volume:s?0:t}),l=Object(m.a)(b,2),j=l[0],f=l[1].stop;return Object(c.useEffect)((function(){return j(),function(){f()}}),[j]),Object(r.jsxs)(L,{children:[Object(r.jsx)(B,{className:"btn btn-danger",onClick:function(){o(t-.01)},children:"-"}),Object(r.jsx)(T,{className:"btn btn-danger",onClick:function(){u(!s)},children:s?"Unmute":"Mute"}),Object(r.jsx)(B,{className:"btn btn-danger",onClick:function(){o(t+.01)},children:"+"})]})};function X(){var n=Object(p.a)(["\n  box-sizing: border-box;\n  margin: 0 0 20px 0;\n  padding: 20px;\n  min-height: 30px;\n  width: 100%;\n  border-radius: 20px;\n  border: none;\n  color: white;\n  background: #333;\n  font-family: Pixel, Arial, Helvetica, sans-serif;\n  font-size: 1rem;\n  outline: none;\n  cursor: pointer;\n"]);return X=function(){return n},n}var Y=x.a.button(X()),Z=function(){var n=Object(c.useContext)(f),e=Object(u.e)();return Object(r.jsx)("div",{children:Object(r.jsx)(Y,{className:"btn btn-danger",onClick:function(){n.emit("leaveRoom"),e.push("/Rooms")},children:"Leave Room"})})};function K(){var n=Object(p.a)(["\n    max-width: 25%;\n"]);return K=function(){return n},n}var W=x.a.aside(K()),q=function(n){return Object(r.jsxs)(W,{children:[n.gameOver?Object(r.jsx)(z,{gameOver:n.gameOver,text:"Game Over"}):Object(r.jsx)("div",{children:Object(r.jsx)(U,{})}),Object(r.jsx)(z,{text:"Score: ".concat(n.score)}),Object(r.jsx)(D,{callback:n.startGame}),Object(r.jsx)(Z,{})]})},F=t(56);function Q(){var n=Object(p.a)(["\n    text-align:center;\n    border: solid;\n    th {\n        border: solid;\n        font-weight:bold;\n        font-size:2vw;\n        padding-right: 20px;\n    }\n    td {\n        font-size:1vw;\n    }\n"]);return Q=function(){return n},n}function V(){var n=Object(p.a)(["\n"]);return V=function(){return n},n}var $=x.a.tbody(V()),_=x.a.tr(Q()),nn=function(n){var e=function(n){var e,t="",r=Object(F.a)(n.keys());try{for(r.s();!(e=r.n()).done;){var c=e.value;t=0!=c?t.concat("-"+n[c]):t.concat(n[c])}}catch(o){r.e(o)}finally{r.f()}return t};return Object(r.jsx)("table",{children:Object(r.jsxs)($,{children:[Object(r.jsxs)(_,{children:[Object(r.jsx)("th",{children:"Player"}),Object(r.jsx)("th",{children:"Score"}),Object(r.jsx)("th",{children:"Spectrum"})]}),Object.keys(n.players).map((function(t,c){return Object(r.jsxs)(_,{children:[Object(r.jsx)("td",{children:n.players[t].name}),Object(r.jsx)("td",{children:n.players[t].score}),Object(r.jsx)("td",{children:e(n.players[t].spectrum)})]},c)}))]})})};function en(){var n=Object(p.a)(["\n  display: flex;\n  flew-flow: row wrap;\n  width: 100%;\n  font-family: Pixel, Arial, Helvetica, sans-serif;\n  font-size: 0.8rem;\n  aside {\n    width: 100%;\n    max-width: 200px;\n    display: block;\n    padding: 0 20px;\n  }\n"]);return en=function(){return n},n}var tn=x.a.div(en()),rn=function(){var n=10,e=20,t=Object(c.useState)([]),o=Object(m.a)(t,2),i=o[0],a=o[1],s=Object(c.useState)({}),b=Object(m.a)(s,2),l=b[0],j=b[1],p=Object(c.useState)({}),x=Object(m.a)(p,2),h=x[0],v=x[1],g=Object(c.useState)(new Array(e).fill().map((function(e){return new Array(n).fill("white")}))),y=Object(m.a)(g,2),C=y[0],S=y[1],R=Object(c.useState)(new Array(e).fill().map((function(e){return new Array(n).fill(0)}))),z=Object(m.a)(R,2),E=z[0],A=z[1],P=Object(c.useState)([]),D=Object(m.a)(P,2),H=D[0],M=D[1],I=Object(c.useContext)(f),L=Object(c.useState)({}),T=Object(m.a)(L,2),B=T[0],G=T[1],J=Object(c.useState)({}),U=Object(m.a)(J,2),X=U[0],Y=U[1],Z=Object(c.useState)(!0),K=Object(m.a)(Z,2),W=K[0],F=K[1],Q=Object(c.useState)(0),V=Object(m.a)(Q,2),$=V[0],_=V[1],en=Object(u.e)(),rn=/#([a-zA-Z]+)\[([a-zA-Z]+)\]/,cn=function(t){return!!t.points.find((function(r){var c=t.position.x+r.x,o=t.position.y+r.y;return c<0||c>=n||o<0||o>=e||"white"!==C[o][c]}))},on=function(n){var e=function(n){for(;!cn(n);)n=N.Down(n);return n=Object(O.a)(Object(O.a)({},n),{},{position:Object(O.a)(Object(O.a)({},n.position),{},{y:n.position.y-1})}),v(n),n}(n),t=E.map((function(n){return n.map((function(n){return 0}))}));j(n),e.points.map((function(n){t[e.position.y+n.y][e.position.x+n.x]=2})),n.points.map((function(e){t[n.position.y+e.y][n.position.x+e.x]=1})),A(Object(d.a)(t))},an=function(){var t=Object(d.a)(C);l.points.map((function(n){t[l.position.y+n.y][l.position.x+n.x]=l.color})),S(Object(d.a)(t));var r=i.shift();i.length<3&&I.emit("getTetris",(function(n){a((function(e){return[].concat(Object(d.a)(e),[n])}))})),cn(r)?(F(!0),I.emit("playerLose")):(t=function(){var e=Object(d.a)(C),t=0;return C.map((function(r,c){r.find((function(n){return"white"===n||"grey"===n}))||(t+=100,e.splice(c,1),e.splice(0,0,new Array(n).fill("white")),I.emit("sendBlackbar"))})),_((function(n){return n+(400===t?2*t:t)})),S(e),Object(d.a)(e)}(),on(r)),I.emit("updateSpectrum",function(t){for(var r=[],c=0;c<n;++c){for(var o=0,i=0;i<e;++i)"white"===t[i][c]&&++o;r.push(o)}return r}(t))};Object(c.useEffect)((function(){for(var t=[],c=0;c<e;++c){for(var o=[],i=0;i<n;++i)o.push(Object(r.jsx)("td",{className:"cell",style:{backgroundColor:1===E[c][i]?l.color:C[c][i],borderWidth:2===E[c][i]?"2px":"1px",borderColor:2===E[c][i]?l.color:"black"}},"".concat(c*n+i)));t.push(Object(r.jsx)("tr",{children:o},"".concat(c)))}M(t)}),[E]),k((function(){W||(cn(N.Down(l))?an():on(N.Down(l)))}),1e3),Object(c.useEffect)((function(){I.on("getBlackbar",(function(){S((function(t){return t.splice(e,0,new Array(n).fill("grey")),t.splice(0,1),t})),j((function(n){return n.position.y-=1,n}))}))}),[]),Object(c.useEffect)((function(){I.on("newTetris",(function(n){a((function(e){return[].concat(Object(d.a)(e),[n])}))}))}),[]);var sn=function(n,e){var t=n,r=Object(d.a)(C);r=r.map((function(n){return n.map((function(n){return"white"}))})),S(r),a(Object(d.a)(e)),j(t),F(!1),_(0)};Object(c.useEffect)((function(){I.on("getSetTetris",(function(n,e){sn(n,e)}))}),[]);return Object(c.useEffect)((function(){var n=rn.exec(location.hash);n?I.emit("joinRoom",n[1],n[2],(function(n,e){n?(en.push("/Rooms"),alert(n)):e.gameInProgress?(en.push("/Rooms"),alert("Game in Progress")):(Y(e),G(e.players))})):en.push("/Home")}),[I]),Object(c.useEffect)((function(){I.on("updatePlayers",(function(n){G(n)}))}),[B,I]),Object(c.useEffect)((function(){return function(){I.emit("leaveRoom")}}),[]),Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)("h1",{children:X.name}),Object(r.jsxs)(tn,{id:"gameSection",role:"button",tabIndex:"0",onKeyDown:function(n){window.addEventListener("keydown",(function(n){[32,37,38,39,40].indexOf(n.keyCode)>-1&&n.preventDefault()}),!1),function(n){37===n.keyCode?cn(N.Left(l))||on(N.Left(l)):39===n.keyCode?cn(N.Right(l))||on(N.Right(l)):38===n.keyCode?cn(N.rotate(l))||on(N.rotate(l)):40===n.keyCode?cn(N.Down(l))?an():(_((function(n){return n+1})),on(N.Down(l))):32===n.keyCode&&(on(h),_((function(n){return n+(h.position.y-l.position.y)})))}(n)},children:[Object(r.jsx)(w,{HTMLgrid:H}),Object(r.jsx)(q,{gameOver:W,startGame:function(){document.getElementById("gameSection").focus(),I.emit("start",(function(n,e){sn(n,e)}))},score:$}),Object(r.jsx)(nn,{players:B})]})]})},cn=function(){var n=Object(u.e)();return Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)("h1",{children:"Bienvenue sur Red Tetris"}),Object(r.jsx)("button",{className:"btn btn-danger",onClick:function(){n.push("/Rooms")},children:"Play"})]})},on=function(n){var e=n.rooms,t=n.createRoom,c=n.joinRoom;return Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)("h1",{children:"Room list"}),Object(r.jsx)("div",{className:"list-group mb-3",children:Object.keys(e).map((function(n,t){return Object(r.jsxs)("li",{className:"list-group-item p-1",children:[Object(r.jsxs)("label",{children:[Object(r.jsx)("b",{children:e[n].name})," ",Object(r.jsxs)("b",{children:["(",Object.keys(e[n].players).length,")"]})]}),Object(r.jsx)("button",{className:"btn btn-danger float-right",disabled:e[n].gameInProgress,onClick:function(){return c(e[n].name)},children:"Join"})]},t)}))}),Object(r.jsx)("button",{className:"btn btn-danger",onClick:t,children:"Create New Room"})]})},an=function(n){var e=n.roomName,t=Object(c.useState)(""),o=Object(m.a)(t,2),i=o[0],a=o[1],s=Object(u.e)();return Object(r.jsxs)("div",{className:"container",children:[Object(r.jsxs)("h1",{children:['Join "',e,'"']}),Object(r.jsxs)("form",{children:[Object(r.jsx)("div",{className:"form-group",children:Object(r.jsx)("input",{className:"form-control",placeholder:"Username",onChange:function(n){a(n.target.value)}})}),Object(r.jsx)("input",{className:"btn btn-danger",type:"submit",value:"Join",onClick:function(n){n.preventDefault(),i&&s.push("/#".concat(e,"[").concat(i,"]"))}})]})]})},sn=(t(94),function(){var n=Object(c.useContext)(f),e=Object(u.e)(),t=Object(c.useState)({}),o=Object(m.a)(t,2),i=o[0],a=o[1],s=Object(c.useState)(null),b=Object(m.a)(s,2),l=b[0],j=b[1],d=function(){e.push("/New-room")},O=function(n){j(n)},p=function(){return l?Object(r.jsx)(an,{roomName:l}):Object(r.jsx)(on,{rooms:i,createRoom:d,joinRoom:O})};return Object(c.useEffect)((function(){n.emit("getRooms",(function(n){a(n)}))}),[n]),Object(c.useEffect)((function(){n.on("updateRooms",(function(n){a(n)}))}),[i]),Object(r.jsx)(p,{})}),un=function(){Object(c.useContext)(f);var n=Object(u.e)(),e=Object(c.useState)(""),t=Object(m.a)(e,2),o=t[0],i=t[1],a=Object(c.useState)(""),s=Object(m.a)(a,2),b=s[0],l=s[1];return Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)("h1",{children:"New Room Creation"}),Object(r.jsxs)("form",{children:[Object(r.jsx)("div",{className:"form-group",children:Object(r.jsx)("input",{className:"form-control",type:"text",placeholder:"Username",onChange:function(n){i(n.target.value)}})}),Object(r.jsx)("div",{className:"form-group",children:Object(r.jsx)("input",{className:"form-control",type:"text",placeholder:"Room name",onChange:function(n){l(n.target.value)}})}),Object(r.jsx)("input",{className:"btn btn-danger",type:"submit",value:"Create",onClick:function(e){e.preventDefault(),o&&b&&n.push("/#".concat(b,"[").concat(o,"]"))}})]})]})},bn=(t(95),function(){return Object(r.jsx)(f.Provider,{value:j,children:Object(r.jsxs)(s.a,{children:[Object(r.jsx)(u.a,{path:"/",exact:!0,component:rn}),Object(r.jsx)(u.a,{path:"/Home",component:cn}),Object(r.jsx)(u.a,{path:"/Rooms",component:sn}),Object(r.jsx)(u.a,{path:"/New-room",component:un})]})})});a.a.render(Object(r.jsx)(bn,{}),document.getElementById("tetris"))}},[[96,1,2]]]);
//# sourceMappingURL=main.538a4c04.chunk.js.map